# Data visualisation

R has a very rich set of graphical functions. The [R Graph Gallery](https://www.r-graph-gallery.com/){target="_blank"} provides a large number of examples (including code).  

```{block2, type = 'rmdtip'}
In this lesson you will get to know the [`ggplot2` library](https://ggplot2.tidyverse.org/){target="_blank"}, which is the most popular library for creating graphics in R. You will learn to create standard graphs such as histograms, boxplots or scatterplots. Furthermore, map making in R will be introduced. 
```

## The Grammar of graphics

The [ggplot2 library](https://ggplot2.tidyverse.org/){target="_blank"} is part of [Tidyverse](https://www.tidyverse.org/){target="_blank"} and offers a series of functions for creating graphics declaratively, based on the concepts outlined in the Grammar of Graphics by Leland Wilkinson.

The grammar of graphics is a schema that enables us to concisely describe the components of a graphic. These components are called **layers of grammatical elements.** Overall the grammar comprises seven layers:

1) Data - The data element is the dataset itself.
2) Aesthetics - This layer defines how variables are mapped onto scales (see description below).
3) Geometries - This element determines how our data is being displayed (bars, points, lines)
4) Facets - Facetting splits the data into subset and displays the same graph for every subset.
5) Statistics - These are statistics derived from the data (add mean, median, quartile).
6) Coordinates - This element determines the transformation of axes (e.g. change spacing of displayed data)
7) Themes - This element determines the graphics background.

The **aestethics layer** offers a number of different options to map data onto visual variables. A **visual variable** is an aspect of a **mark** that can be controlled to change its appearance.

Visual variables are: 

- Size
- Shape 
- Orientation
- Colour (hue)
- Colour value (brightness)
- Texture
- Position (map variable to x or y axis) 

For instance, in Figure \@ref(fig:L07-colsize) variables 'Gdp per capita' and  'Life Expectancy' are mapped onto the x and y axes, variables 'national population' and 'world regions' are mapped onto visual variables size and color.

```{r L07-colsize, echo=FALSE, fig.cap="Visual variables color and size", out.width='90%', fig.asp=.75, fig.align='center'}
knitr::include_graphics('images/VisualVar.png')
```

In order to make that concepts clearer, a number of examples will me presented in upcoming sections.

```{block2, type = 'rmdtip'}
The basic concept behind the grammar of graphics is described in an [article](https://byrneslab.net/classes/biol607/readings/wickham_layered-grammar.pdf){target="_blank"} by Hadley Wickham.  
```

## Visualization of distributions

As already announced above, functions in the `ggplot2` library are structured according to the Grammar of Graphics. To create a graph in `ggplot2`, we need to provide input data, specify visual variables by means of an aesthetics element (`aes()`), specify the geometry of marks (e.g., `geom_point`) and apply transformations (axis spacing) and themes (background theme of the graph).

In the code example below, the first argument in `ggplot2` is the data input (a data frame). In the second argument, we map the data onto the x-axis and y-axis with the aesthetics argument `aes()`.



`ggplot2` plots are objects which means that you can assign them. If we would display the plot now then we wouldnâ€™t see anything yet because we have not specified the geometric element yet.

object oriented programming tip...





## Boxplots

- `x` categorical variable
- `y` variable to plot
- `geom_boxplot`






## Jittered points

- `x` categorical variable
- `y` variable to plot
- `geom_jitter`





## Violin plot

- `x` categorical variable
- `y` variable to plot
- `geom_violin`




## Violin plot




## Lines

- `x` e.g., a temporal variable
- `y` variable to plot
- `geom_line`




## Lines





## Scatterplots

- `x` and `y` variable to plot
- `geom_point`





## Overlapping points

- `x` and `y` variable to plot
- `geom_count` counts overlapping points and maps the count to size




## Overlapping points



## Bin counts

- `x` and `y` variable to plot
- `geom_bin2d`


## Bin counts





## Summary

Data visualisation

- Grammar of graphics
- ggplot2

**Next**: Descriptive statistics

- stat.desc
- dplyr::across

